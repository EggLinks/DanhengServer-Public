# Danheng Server

**__ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯é–‹ç™ºä¸­ã§ã™ï¼__**

<p align="center">
<a href="https://visualstudio.com"><img src="https://img.shields.io/badge/Visual%20Studio-000000.svg?style=for-the-badge&logo=visual-studio&logoColor=white" /></a>
<a href="https://dotnet.microsoft.com/"><img src="https://img.shields.io/badge/.NET-000000.svg?style=for-the-badge&logo=.NET&logoColor=white" /></a>
<a href="https://www.gnu.org/"><img src="https://img.shields.io/badge/GNU-000000.svg?style=for-the-badge&logo=GNU&logoColor=white" /></a>
</p>
<p align="center">
  <a href="https://discord.gg/xRtZsmHBVj"><img src="https://img.shields.io/badge/Discord%20Server-000000.svg?style=for-the-badge&logo=Discord&logoColor=white" /></a>
</p>

[EN](../README.md) | [ç°¡ä¸­](README_zh-CN.md) | [ç¹ä¸­](README_zh-CN.md) | [JP](README_ja-JP.md)

## ğŸ’¡æ©Ÿèƒ½

- [âˆš] **ã‚¹ãƒˆã‚¢æ©Ÿèƒ½**
- [âˆš] **ãƒãƒ¼ãƒ ã‚’ç·¨æˆã™ã‚‹**
- [âˆš] **ãƒ‰ãƒ­ãƒ¼** - ã‚«ã‚¹ã‚¿ãƒ å¯èƒ½ãªç¢ºç‡: )
- [âˆš] **ã¨æˆ¦ã†** - ã‚·ãƒ¼ãƒ³ã‚¹ã‚­ãƒ«ã«ã„ãã¤ã‹ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™
- [âˆš] **ã‚·ãƒ¼ãƒ³** - æ­©è¡Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã€æ­£ç¢ºãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ­ãƒ¼ãƒ‰
- [âˆš] **åŸºæœ¬çš„ãªå½¹å‰²è‚²æˆ** - ã¡ã‚‡ã£ã¨ãƒã‚°ãŒã‚ã‚Šã¾ã™ãŒã€å½±éŸ¿ã¯ã‚ã¾ã‚Šã‚ã‚Šã¾ã›ã‚“
- [âˆš] **ã‚¿ã‚¹ã‚¯ï¼ƒã‚¿ã‚¹ã‚¯ï¼ƒ** - ä¸€éƒ¨ã®ã‚¿ã‚¹ã‚¯ã«ã¯ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒ™ãƒ­ãƒ–ãƒ«ã‚°ã®ä¸»è¦ãªã‚¿ã‚¹ã‚¯ã¯ã™ã¹ã¦å®Œäº†ã—ã¦ã„ã¾ã™ã€‚ç”·æ€§ä¸»äººå…¬ã¨å¥³æ€§ä¸»äººå…¬ã«ã¯ã¾ã ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“
- [-] **äº¤å‹æ©Ÿèƒ½**
- [-] **å¿˜å´ã®åº­ & è™šæ§‹å™äº‹**
- [-] **æ¨¡æ“¬å®‡å®™**

- [ ] **è©³ç´°**  - Coming soon...

ã€Œã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ ã‚²ãƒ¼ãƒ ã€ã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹ã¨ã€æœ€åˆã¯ä¸€éƒ¨ã®æ©Ÿèƒ½ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œãªããªã‚Šã¾ã™ã€‚å¼•ãç¶šãã€ç§ãŸã¡ã®æŠ•ç¨¿ã«ã”æ³¨æ„ãã ã•ã„ã€‚  ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 2.3 ä»¥é™ã€ãƒ™ãƒ¼ã‚¿ç‰ˆã«é©ã—ãŸãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ ãƒ–ãƒ©ãƒ³ãƒã‚’è¨­ç«‹ã—ã€æº–å‚™ãŒå®Œäº†æ¬¡ç¬¬ã€ãƒ¡ã‚¤ãƒ³ ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹ã«ãƒãƒ¼ã‚¸ã•ã‚Œã¾ã™ã€‚

## ğŸ—ä½¿ç”¨&ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

1. [Action](https://github.com/StopWuyu/DanhengServer/actions) ã§å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
2. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ãŸ` DanhengServer.zip `ã‚’é–‹ã„ã¦ä»»æ„ã®ãƒ•ã‚©ãƒ«ãƒ€ã«è§£å‡ã—ã¾ã™ __*è‹±æ–‡ãƒ‘ã‚¹ãŒæœ›ã¾ã—ã„*__

> (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®WebServerãƒ•ã‚©ãƒ«ãƒ€ã«` certificate.p 12 `ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã€HTTPSãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¦è»¢é€ã‚’ã‚ˆã‚Šå®‰å…¨ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™: )

3. GameServer.exeã®å®Ÿè¡Œ
4. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•ã‚²ãƒ¼ãƒ ã®å®Ÿè¡Œ

### æ§‹ç¯‰ï¼ƒã‚³ã‚¦ãƒã‚¯ï¼ƒ

Danhengserver Dotnetã‚’ä½¿ç”¨ã—ãŸæ§‹ç¯‰

**ãƒ—ãƒªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼š**

- [.NET](https://dotnet.microsoft.com/)
- [Git](https://git-scm.com/downloads)

##### Windows

```shell
git clone --recurse-submodules https://github.com/StopWuyu/DanhengServer.git
cd DanhengServer
.\dotnet build # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
```

##### Linux ï¼ˆUbuntu20.04ï¼‰
- ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç’°å¢ƒ
```shell
# Microsoftãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªãƒã‚¸ãƒˆãƒªã®è¿½åŠ 
wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
rm packages-microsoft-prod.deb

# SDKã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt-get update && \
  sudo apt-get install -y dotnet-sdk-8.0
```

- ç’°å¢ƒã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦å®Ÿè¡Œã™ã‚‹
```shell
git clone --recurse-submodules https://github.com/StopWuyu/DanhengServer.git
cd DanhengServer
.\dotnet build # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
./Gameserver
```
**ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯Microsoftã«è¡¨ç¤ºã—ã¦ãã ã•ã„**
- [Microsoftã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](https://dotnet.microsoft.com/zh-cn/download/dotnet/thank-you/sdk-8.0.204-linux-x64-binaries)

## â“ãƒ˜ãƒ«ãƒ—

- ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã®ã‚µãƒãƒ¼ãƒˆ
- 100040119ï¼ˆè‡ªå‹•å®Œäº†ã§ãã¾ã›ã‚“ï¼‰ï¼ˆ/mission finish 100040119 ã‚’ä½¿ç”¨ã—ãŸä¿®æ­£ï¼‰

##ğŸ’¡APIæ”¯æ´ã§ã™

-ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.3ã‹ã‚‰ã€å¤–éƒ¨APIå‘¼ã³å‡ºã—ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
-å…¨ä½“ã®ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã¯Dispatchã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã«å…¥å£ã‚’åŠ ãˆã¾ã™ã€‚ä¾‹ãˆã°ã€Dispatchã¯http://127.0.0.1:8080ã€è¦æ±‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒªã‚¿ãƒ¼ãƒ³ã¯jsonå½¢å¼ã§ã™ã€‚
-(1)ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹:http://127.0.0.1:8080/muip/auth_admin(æ”¯æŒãƒã‚¹ãƒˆ/ get)
- -å¿…é ˆå¼•æ•°1:admin_key (config.phpã§ã®MuipServer/AdminKeyæ§‹æˆ)
- -å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿2:key_type(ã‚¿ã‚¤ãƒ—ã€ä¾‹ãˆã°PEM)ã§ã™ã€‚
- -ãƒªã‚¿ãƒ¼ãƒ³ä¾‹ã§ã™:
```json
  {
    "code": 0,
    "message": "Authorized admin key successfully!",
    "data": {
        "rsaPublicKey": "***",
        "sessionId": "***",
        "expireTimeStamp": ***
    }
  }
```
â€”(2)æå‡ºå‘½ä»¤ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹:http://127.0.0.1:8080/muip/exec_cmd(æ”¯æŒãƒã‚¹ãƒˆ/ get)
- -å¿…ä¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿1:SessionId(ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¦æ±‚å¾Œã«å–å¾—ã—ã¾ã™)
- -å¿…é ˆå¼•æ•°2:Command(å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’rsaPublicKey[ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å–å¾—]ã§RSA[pacs#1]ã§æš—å·åŒ–ã—ã¾ã™)
- -å¿…ä¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿3:TargetUid(ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼UID)ã§ã™
- -ãƒªã‚¿ãƒ¼ãƒ³ä¾‹ã§ã™:
```json
    {
      "code": 0,
      "message": "Success",
      "data": {
          "sessionId": "***",
          "message": "*** //base64ç¼–ç å
      }
    }
```
â€”(3)ã‚µãƒ¼ãƒãƒ¼ã®çŠ¶æ…‹ã‚’ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹:http://127.0.0.1:8080/muip/server_information(æ”¯æŒget)ã ã‘
- -å¿…ä¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿1:SessionId(ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¦æ±‚å¾Œã«å–å¾—ã—ã¾ã™)
- -ãƒªã‚¿ãƒ¼ãƒ³ä¾‹ã§ã™:
```json
    {
      "code": 0,
      "message": "Success",
      "data": {
          "onlinePlayers": [
              {
                  "uid": 10001,
                  "name": "KEVIN",
                  "headIconId": 208001
              },
              ....
          ],
          "serverTime": 1720626191,
          "maxMemory": 16002.227,
          "usedMemory": 7938.5547,
         "programUsedMemory": 323
      }
    }
```
â€”(4)ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±ã‚’ç›—ã¿å‡ºã™ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹:http://127.0.0.1:8080/muip/player_information(æ”¯æŒget)ã ã‘
- -å¿…ä¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿1:SessionId(ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¦æ±‚å¾Œã«å–å¾—ã—ã¾ã™)
- -å¿…ä¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼2:Uid(ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼Uid)
- -ãƒªã‚¿ãƒ¼ãƒ³ä¾‹ã§ã™:
```json
    {
      "code": 0,
      "message": "Success",
      "data": {
          "uid": 10001,
          "name": "KEVIN",
          "signature": "",
          "headIconId": 208001,
          "curPlaneId": 10001,
          "curFloorId": 10001001,
          "playerStatus": "Explore",
          "stamina": 182,
          "recoveryStamina": 4,
          "assistAvatarList": Array[0],
          "displayAvatarList": Array[0],
          "finishedMainMissionIdList": Array[38],
          "finishedSubMissionIdList": Array[273],
          "acceptedMainMissionIdList": Array[67],
          "acceptedSubMissionIdList": Array[169]
      }
  }
```

## â•ï¸ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ä¸€èˆ¬çš„ãªå•é¡Œã®è§£æ±ºç­–ã‚’å…¥æ‰‹ã™ã‚‹ã‹ã€ãƒ˜ãƒ«ãƒ—ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚[ãƒ‡ãƒ«ã®Discordã‚µãƒ¼ãƒ](https://discord.gg/xRtZsmHBVj)

## ğŸ™Œã«æ„Ÿè¬

- Weedwacker - kcpå®Ÿè£…ã®æä¾›
- [SqlSugar](https://github.com/donet5/SqlSugar) - ORMã®æä¾›
- [LunarCore](https://github.com/Melledy/LunarCore) - ã„ãã¤ã‹ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
